<!DOCTYPE html><html lang="zh-cn"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><title>hello-koa2 | 腹有诗书气自华</title><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="author" content="[object Object]"><meta name="designer" content="minfive"><meta name="keywords" content="前端博客, 前端, 程序员, 前端开发, vue, node.js, javascript"><meta name="description" content="日常学习与兴趣交流的个人博客"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=yes"><meta name="mobile-web-app-capable" content="yes"><meta name="robots" content="all"><link rel="canonical" href="18600917746.github.io/2019/01/21/hello-koa2/index.html"><link rel="icon" type="image/png" href="/images/favicon.ico" sizes="32x32"><link rel="stylesheet" href="/scss/base/index.css"><link rel="alternate" href="/atom.xml" title="cheng"><link rel="stylesheet" href="/scss/views/page/post.css"></head><body ontouchstart=""><div id="page-loading" class="page page-loading" style="background-image:url(/images/loader.gif)"></div><div id="page" class="page js-hidden"><header class="page__small-header page__header--small"><nav class="page__navbar"><div class="page__container navbar-container"><a class="page__logo" href="/" title="cheng" alt="cheng"><img src="/images/images.jpeg" alt="cheng"></a><nav class="page__nav"><ul class="nav__list clearfix"><li class="nav__item"><a href="/" alt="首页" title="首页">首页</a></li><li class="nav__item"><a href="/archives" alt="归档" title="归档">归档</a></li><li class="nav__item"><a href="/about" alt="关于" title="关于">关于</a></li></ul></nav><button class="page__menu-btn" type="button"><i class="iconfont icon-menu"></i></button></div></nav></header><main class="page__container page__main"><div class="page__content"><article class="page__post"><div class="post__cover"><img src="/images/default-bg.jpg" alt="hello-koa2"></div><header class="post__info"><h1 class="post__title">hello-koa2</h1><div class="post__mark"><div class="mark__block"><i class="mark__icon iconfont icon-write"></i><ul class="mark__list clearfix"><li class="mark__item"><a href="/">cheng</a></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-time"></i><ul class="mark__list clearfix"><li class="mark__item"><span>2019-01-21</span></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-tab"></i><ul class="mark__list clearfix"><li class="mark__item"><a href="/tags/nodeJS/">nodeJS</a></li><li class="mark__item"><a href="/tags/koa2/">Koa2</a></li></ul></div></div></header><div class="post__content"><h2 id="koa入手先知"><a href="#koa入手先知" class="headerlink" title="koa入手先知"></a>koa入手先知</h2><p><code>Koa</code> 是一个新的 <code>web</code> 框架，由 <code>Express</code> 幕后的原班人马打造， 致力于成为 <code>web</code> 应用和 <code>API</code> 开发领域中的一个更小、更富有表现力、更健壮的基石。 通过利用 <code>async</code> 函数，<code>Koa</code> 帮你丢弃回调函数，并有力地增强错误处理。 <code>Koa</code> 并没有捆绑任何中间件， 而是提供了一套优雅的方法，帮助您快速而愉快地编写服务端应用程序。</p><ul><li><code>koa</code>的<code>路由中间件</code>需要安装<code>koa-router</code>模块来实现</li></ul><h3 id="koa安装"><a href="#koa安装" class="headerlink" title="koa安装"></a>koa安装</h3><ul><li>首先你要确定你已经安装的nodeJS</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node -v</span><br></pre></td></tr></table></figure><ul><li>创建空文件夹并初始化package.json包管理配置文件</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir mykoa</span><br><span class="line">cd myapp</span><br><span class="line">npm init</span><br></pre></td></tr></table></figure><ul><li>安装<code>koa2</code>包</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install koa --save</span><br><span class="line">npm install koa-router --save</span><br></pre></td></tr></table></figure><h3 id="通过koa启动一个简单的server服务"><a href="#通过koa启动一个简单的server服务" class="headerlink" title="通过koa启动一个简单的server服务"></a>通过<code>koa</code>启动一个简单的<code>server</code>服务</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.js</span></span><br><span class="line"><span class="keyword">const</span> Koa = <span class="built_in">require</span>(<span class="string">'koa'</span>);</span><br><span class="line"><span class="keyword">const</span> router = <span class="built_in">require</span>(<span class="string">'koa-router'</span>)();</span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Koa();</span><br><span class="line"></span><br><span class="line">router.get(<span class="string">'/'</span>, <span class="keyword">async</span> ctx =&gt; &#123;</span><br><span class="line">  ctx.body = <span class="string">'Hello koa2'</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.use(router.routes()).use(router.allowedMethods());</span><br><span class="line">app.listen(<span class="number">3000</span>, () =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'服务已开启'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="koa应用生成器"><a href="#koa应用生成器" class="headerlink" title="koa应用生成器"></a>koa应用生成器</h3><ul><li>使用koa社区比较活跃的方式生成与<code>express-generator</code>类似的框架</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g koa-generator</span><br></pre></td></tr></table></figure><ul><li>koa-generator支持<code>1.x</code>与<code>2.x</code>的生成【建议与时俱进】</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">koa2 myapp</span><br></pre></td></tr></table></figure><ul><li>安装依赖包</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd myapp</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure><ul><li>启动服务</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm start</span><br></pre></td></tr></table></figure><h3 id="koa实例方法"><a href="#koa实例方法" class="headerlink" title="koa实例方法"></a>koa实例方法</h3><ul><li>app.use 注册中间件</li><li>app.callback 返回适用于 http.createServer() 方法的回调函数来处理请求</li><li>app.keys 设置签名的 Cookie 密钥</li><li>app.context app.context 是从其创建 ctx 的原型。您可以通过编辑 app.context 为 ctx 添加其他属性。</li><li>app.listen 绑定端口</li></ul><h3 id="koa核心成员-ctx"><a href="#koa核心成员-ctx" class="headerlink" title="koa核心成员 ctx"></a>koa核心成员 <code>ctx</code></h3><ul><li>Request<ul><li>ctx.req <code>node</code> 的 <code>request</code> 对象</li><li>ctx.request <code>koa</code> 的 <code>Request</code> 对象【推荐使用】</li><li>ctx.header 请求标头对象</li><li>ctx.header= 设置请求标头对象</li><li>ctx.headers 请求标头对象【别名 ctx.header 】</li><li>ctx.headers= 设置标头对象【别名 ctx.header= 】</li><li>ctx.method 请求方法</li><li>ctx.method= 设置请求方法，对于实现诸如 <code>methodOverride()</code> 的中间件是有用的。</li><li>ctx.url 获取请求 <code>URL</code></li><li>ctx.url= 设置请求 <code>URL</code>, 对 <code>url</code> 重写有用。</li><li>ctx.originalUrl 获取请求原始URL。</li><li>ctx.origin 获取URL的来源，包括 protocol 和 host。</li><li>ctx.href</li><li>ctx.path</li><li>ctx.path=</li><li>ctx.query</li><li>ctx.query=</li><li>ctx.querystring</li><li>ctx.querystring=</li><li>ctx.host</li><li>ctx.hostname</li><li>ctx.fresh</li><li>ctx.stale</li><li>ctx.socket</li><li>ctx.protocol</li><li>ctx.secure</li><li>ctx.ip</li><li>ctx.ips</li><li>ctx.subdomains</li><li>ctx.is()</li><li>ctx.accepts()</li><li>ctx.acceptsEncodings()</li><li>ctx.acceptsCharsets()</li><li>ctx.acceptsLanguages()</li><li>ctx.get()</li></ul></li><li>Response<ul><li>ctx.res <code>node</code> 的 <code>request</code> 对象</li><li>ctx.response <code>koa</code> 的 <code>Response</code> 对象【推荐使用】</li><li>ctx.body</li><li>ctx.body=</li><li>ctx.status</li><li>ctx.status=</li><li>ctx.message</li><li>ctx.message=</li><li>ctx.length= 返回以数字返回请求的 Content-Length，或 undefined。</li><li>ctx.length 返回以数字返回请求的 Content-Length，或 undefined。</li><li>ctx.type= 设置返回的数据类型</li><li>ctx.type 获取请求的数据类型</li><li>ctx.headerSent</li><li>ctx.redirect()</li><li>ctx.attachment()</li><li>ctx.set()</li><li>ctx.append()</li><li>ctx.remove()</li><li>ctx.lastModified=</li><li>ctx.etag=</li></ul></li><li>state<ul><li>ctx.state 推荐使用的命名空间，可以挂载一些公用的数据</li></ul></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctx.state.user = <span class="keyword">await</span> User.find(id);</span><br></pre></td></tr></table></figure><ul><li><p>cookies</p><ul><li>ctx.cookies.get 获取 <code>cookie</code> 的 <code>name</code></li><li>ctx.cookies.set 设置 <code>cookie</code> 的相关信息<ul><li>axAge 一个数字表示从 <code>Date.now()</code> 得到的毫秒数</li><li>signed cookie 签名值</li><li>expires cookie 过期的 Date</li><li>path cookie 路径, 默认是<code>&#39;/&#39;</code></li><li>domain <code>cookie</code> 域名</li><li>secure 安全 <code>cookie</code></li><li>httpOnly 服务器可访问 <code>cookie</code>, 默认是 <code>true</code></li><li>overwrite 一个布尔值，表示是否覆盖以前设置的同名的 <code>cookie</code> (默认是 <code>false</code>). 如果是 <code>true</code>, 在同一个请求中设置相同名称的所有 <code>Cookie</code>（不管路径或域）是否在设置此 <code>Cookie</code> 时从 <code>Set-Cookie</code> 标头中过滤掉。</li></ul></li></ul></li><li><p>throw</p><ul><li>ctx.throw 创建错误 - <a href="https://github.com/jshttp/http-errors" target="_blank" rel="noopener">http-errors</a></li></ul></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ctx.throw(<span class="number">400</span>);</span><br><span class="line">ctx.throw(<span class="number">400</span>, <span class="string">'name required'</span>);</span><br><span class="line">ctx.throw(<span class="number">400</span>, <span class="string">'name required'</span>, &#123; <span class="attr">user</span>: user &#125;);</span><br></pre></td></tr></table></figure><ul><li>assert<ul><li>ctx.assert 断言模块 - <a href="https://github.com/jshttp/http-assert" target="_blank" rel="noopener">http-assert</a></li></ul></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctx.assert(ctx.state.user, <span class="number">401</span>, <span class="string">'User not found. Please login!'</span>);</span><br></pre></td></tr></table></figure><h3 id="同一个应用程序同时作为-HTTP-和-HTTPS-或多个地址"><a href="#同一个应用程序同时作为-HTTP-和-HTTPS-或多个地址" class="headerlink" title="同一个应用程序同时作为 HTTP 和 HTTPS 或多个地址"></a>同一个应用程序同时作为 HTTP 和 HTTPS 或多个地址</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">const</span> https = <span class="built_in">require</span>(<span class="string">'https'</span>);</span><br><span class="line"><span class="keyword">const</span> Koa = <span class="built_in">require</span>(<span class="string">'koa'</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Koa();</span><br><span class="line">http.createServer(app.callback()).listen(<span class="number">3000</span>);</span><br><span class="line">https.createServer(app.callback()).listen(<span class="number">3001</span>);</span><br></pre></td></tr></table></figure><h3 id="koa-最经典的-洋葱模型"><a href="#koa-最经典的-洋葱模型" class="headerlink" title="koa 最经典的 洋葱模型"></a>koa 最经典的 洋葱模型</h3><p><img src="./koa.png" alt=""><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">app.use(<span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">await</span> next();</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.use(<span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">3</span>);</span><br><span class="line">  <span class="keyword">await</span> next();</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">4</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.use(<span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">5</span>);</span><br><span class="line">  <span class="keyword">await</span> next();</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">6</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 3</span></span><br><span class="line"><span class="comment">// 5</span></span><br><span class="line"><span class="comment">// 6</span></span><br><span class="line"><span class="comment">// 4</span></span><br><span class="line"><span class="comment">// 2</span></span><br></pre></td></tr></table></figure><p></p><h3 id="koa-处理-get-请求"><a href="#koa-处理-get-请求" class="headerlink" title="koa 处理 get 请求"></a>koa 处理 get 请求</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">router.get(<span class="string">'/get'</span>, <span class="keyword">async</span> ctx =&gt; &#123;</span><br><span class="line">  ctx.body = &#123;</span><br><span class="line">    req: ctx.request.query,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="koa-处理-动态路由-请求"><a href="#koa-处理-动态路由-请求" class="headerlink" title="koa 处理 动态路由 请求"></a>koa 处理 动态路由 请求</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">router.get(<span class="string">'/get/:id'</span>, <span class="keyword">async</span> ctx =&gt; &#123;</span><br><span class="line">  ctx.body = &#123;</span><br><span class="line">    req: ctx.params.id,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="koa-处理-post-请求"><a href="#koa-处理-post-请求" class="headerlink" title="koa 处理 post 请求"></a>koa 处理 post 请求</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">'koa-bodyparser'</span>);</span><br><span class="line">app.use(bodyParser());</span><br><span class="line">router.post(<span class="string">'/post'</span>, <span class="keyword">async</span> ctx =&gt; &#123;</span><br><span class="line">  ctx.body = &#123;</span><br><span class="line">    req: ctx.request.body,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="koa-处理-图片-请求"><a href="#koa-处理-图片-请求" class="headerlink" title="koa 处理 图片 请求"></a>koa 处理 图片 请求</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs= <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line">router.get(<span class="string">'/koa'</span>, <span class="keyword">async</span> ctx =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'触发'</span>);</span><br><span class="line">  <span class="keyword">let</span> data = fs.createReadStream(<span class="string">'./public/koa.png'</span>);</span><br><span class="line">  ctx.type = <span class="string">'.png'</span>;</span><br><span class="line">  ctx.body = data;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="koa-处理-文件上传-请求"><a href="#koa-处理-文件上传-请求" class="headerlink" title="koa 处理 文件上传 请求"></a>koa 处理 文件上传 请求</h3><h3 id="koa-处理-文件下载-请求"><a href="#koa-处理-文件下载-请求" class="headerlink" title="koa 处理 文件下载 请求"></a>koa 处理 文件下载 请求</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs= <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line">router.get(<span class="string">'/koa'</span>, <span class="keyword">async</span> ctx =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'触发'</span>);</span><br><span class="line">  <span class="keyword">let</span> data = fs.createReadStream(<span class="string">'./static/koa.txt'</span>);</span><br><span class="line">  ctx.type = <span class="string">'application/octet-stream'</span>;</span><br><span class="line">  ctx.body = data;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="koa-模板引擎-【需要-views-中间件支持】"><a href="#koa-模板引擎-【需要-views-中间件支持】" class="headerlink" title="koa 模板引擎 【需要 views 中间件支持】"></a>koa 模板引擎 【需要 views 中间件支持】</h3><ul><li>安装 views 中间件</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save koa-views</span><br></pre></td></tr></table></figure><ul><li>ejs</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install ejs --save</span><br></pre></td></tr></table></figure><ul><li>设置渲染引擎</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.use(views(path.join(__dirname, <span class="string">'./views'</span>), &#123;</span><br><span class="line">  extension: <span class="string">'ejs'</span>,</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure><ul><li>创建一个简单的index.ejs骨架</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;<span class="name">%=</span> <span class="attr">title</span> %&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="tag">&lt;<span class="name">%=</span> <span class="attr">message</span> %&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>根据路由传递参数，并渲染页面</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">router.get(<span class="string">'/ejs'</span>, <span class="keyword">async</span> ctx =&gt; &#123;</span><br><span class="line">  <span class="keyword">await</span> ctx.render(<span class="string">'ejs'</span>, &#123;</span><br><span class="line">    title: <span class="string">'ejs'</span>,</span><br><span class="line">    message: <span class="string">'Hello koa - ejs'</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><div class="post-announce">感谢您的阅读，本文由 <a href="18600917746.github.io">cheng</a> 版权所有。如若转载，请注明出处：cheng（<a href="18600917746.github.io/2019/01/21/hello-koa2/">18600917746.github.io/2019/01/21/hello-koa2/</a>）</div><div class="post__prevs"><div class="post__prev"><a href="/2019/01/19/hello-express/" title="hello-express"><i class="iconfont icon-prev"></i>hello-express</a></div><div class="post__prev post__prev--right"><a href="/2019/01/21/node-js与io-js/" title="node.js与io.js">node.js与io.js<i class="iconfont icon-next"></i></a></div></div></div></article></div><aside class="page__sidebar"><form id="page-search-from" class="page__search-from" action="/search/"><label class="search-form__item"><input class="input" type="text" name="search" placeholder="Search..."> <i class="iconfont icon-search"></i></label></form><div class="sidebar__block"><h3 class="block__title">简介</h3><p class="block__text">日常学习与兴趣交流的个人博客</p></div><div class="sidebar__block"><h3 class="block__title">文章分类</h3><ul class="block-list"><li class="block-list-item"><a class="block-list-link" href="/categories/前端/">前端</a><span class="block-list-count">4</span></li></ul></div><div class="sidebar__block"><h3 class="block__title">最新文章</h3><ul class="block-list latest-post-list"><li class="latest-post-item"><a href="/2019/01/21/node-js与io-js/" title="node.js与io.js"><div class="item__cover"><img src="/images/default-bg.jpg" alt="node.js与io.js"></div><div class="item__info"><h3 class="item__title">node.js与io.js</h3><span class="item__text">2019-01-21</span></div></a></li><li class="latest-post-item"><a href="/2019/01/21/hello-koa2/" title="hello-koa2"><div class="item__cover"><img src="/images/default-bg.jpg" alt="hello-koa2"></div><div class="item__info"><h3 class="item__title">hello-koa2</h3><span class="item__text">2019-01-21</span></div></a></li><li class="latest-post-item"><a href="/2019/01/19/hello-express/" title="hello-express"><div class="item__cover"><img src="/images/default-bg.jpg" alt="hello-express"></div><div class="item__info"><h3 class="item__title">hello-express</h3><span class="item__text">2019-01-19</span></div></a></li><li class="latest-post-item"><a href="/2019/01/19/hello-node/" title="hello-node"><div class="item__cover"><img src="/images/default-bg.jpg" alt="hello-node"></div><div class="item__info"><h3 class="item__title">hello-node</h3><span class="item__text">2019-01-19</span></div></a></li></ul></div><div class="sidebar__block"><h3 class="block__title">文章标签</h3><ul class="block-list tag-list clearfix"><li class="tag-item"><a class="tag-link" href="/tags/Express/">Express</a></li><li class="tag-item"><a class="tag-link" href="/tags/io-js/">io.js</a></li><li class="tag-item"><a class="tag-link" href="/tags/koa2/">koa2</a></li><li class="tag-item"><a class="tag-link" href="/tags/node-js/">node.js</a></li><li class="tag-item"><a class="tag-link" href="/tags/nodeJS/">nodeJS</a></li><li class="tag-item"><a class="tag-link" href="/tags/茶余饭后/">茶余饭后</a></li></ul></div></aside></main><footer class="page__footer"><section class="footer__top"><div class="page__container footer__container"><div class="footer-top__item footer-top__item--2"><h3 class="item__title">关于</h3><div class="item__content"><p class="item__text">本站是基于 Hexo 搭建的静态资源博客，主要用于分享日常学习、生活及工作的一些心得总结。</p><ul class="footer__contact-info"><li class="contact-info__item"><i class="iconfont icon-address"></i> <span>BeiJing, China</span></li><li class="contact-info__item"><i class="iconfont icon-email2"></i> <span>18600917746@163.com</span></li></ul></div></div><div class="footer-top__item footer__image"><img src="/images/pay.jpg" alt="logo" title="cheng"></div><div class="footer-top__item"><h3 class="item__title">友情链接</h3><div class="item__content"><ul class="footer-top__list"><li class="list-item"><a href="https://github.com/Mrminfive/hexo-theme-skapp" title="hexo-theme-skapp" target="_blank">hexo-theme-skapp</a></li></ul></div></div><div class="footer-top__item"><h3 class="item__title">构建工具</h3><div class="item__content"><ul class="footer-top__list"><li class="list-item"><a href="https://hexo.io/" title="Blog Framework" target="_blank">Hexo</a></li></ul></div></div></div></section><section class="footer__bottom"><div class="page__container footer__container"><p class="footer__copyright">© <a href="https://github.com/Mrminfive/hexo-theme-skapp" target="_blank">Skapp</a> 2017 powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, made by <a href="https://github.com/Mrminfive" target="_blank">minfive</a>.</p><ul class="footer__social-network clearfix"><li class="social-network__item"><a href="https://github.com/Mrminfive" target="_blank" title="github"><i class="iconfont icon-github"></i></a></li><li class="social-network__item"><a href="mailto:chenxiaowu1994@outlook.com" target="_blank" title="email"><i class="iconfont icon-email"></i></a></li><li class="social-network__item"><a href="/atom.xml" target="_blank" title="rss"><i class="iconfont icon-rss"></i></a></li></ul></div></section></footer><div id="back-top" class="back-top back-top--hidden js-hidden"><i class="iconfont icon-top"></i></div></div><script src="/js/common.js"></script><script src="/js/page/post.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></body></html>